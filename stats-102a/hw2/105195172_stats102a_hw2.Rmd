---
title: "Stats 102A - HW 2"
author: "Zooey Nguyen"
date: "2/8/2021"
output: pdf_document
---

I would like to preface this assignment by saying I am sorry, I somehow lost track of this homework assignment and was only able to do a little bit of it, which is why it is clearly incomplete and rushed. It is very much not my best work. Thank you for grading, whoever is doing so.


```{r}
source("105195172_stats102a_hw2.R")
library(tidyverse)
```


## Problem 1

### Part a

This first example is from the Fermi-LAT catalog I worked with in my research. The data is messy because not all cells have a single value. For example, they include "Other Observatory Detections" as a column, and not all GRBs have comments on them. In the redshift column there may be multiple values listed in a single cell because of conflicting calculations of redshift, and in fact, most GRBs have no spectral analysis done at all to calculate redshift.

```{r}
grbs <- read_tsv("grb_table.txt")
grbs_example <- grbs[c("GRB", "Time [UT]", "Other Observatory Detections", "Redshift")]
head(grbs_example, 10)
```

### Part b
This data might be better arranged if flexible or blank observations were excluded from the dataset completely, since it creates messiness when you need to conduct analysis on, say, GRBs with redshift, or when you need statistics on actually relevant columns to analysis, which the commentary columns do not help. Here is how we might fix the example dataset:

```{r}
clean_df <- grbs_example %>%
  drop_na("Redshift") %>%
  separate("Redshift", into=c("Redshift", "Technique"), sep="\\(") %>%
  select(-c("Other Observatory Detections", "Technique"))
head(clean_df, 10)
```
Now we have a nice clean dataset for gamma-ray bursts and their corresponding calculated redshifts.

## Problem 2

### Part a
Simulating the gradebook dataset.
```{r}
set.seed(105195172)
gradebook_df <- data.frame(matrix(ncol=14, nrow=150))
colnames(gradebook_df) <- c("UID", paste("Homework", 1:10, sep="_"), paste("Exam", 1:3, sep="_"))
UID <- 123456789
for (i in 1:150) {
  UID <- UID + 1
  grades <- rnorm(13, mean=70, sd=15)
  grades[grades > 100] <- 100
  grades[grades < 0] <- 0
  grades <- round(grades, digits=0)
  gradebook_df[i,] <- c(UID, grades)
}
gradebook <- as_tibble(gradebook_df)
```

### Part b
Randomly replacing 10% of Homework_10 and 5% of Exam_3 by NA.
```{r}
hw_na <- sample(1:150, 15)
exam_na <- sample(1:150, 8)
gradebook[hw_na, "Homework_10"] <- NA
gradebook[exam_na, "Exam_3"] <- NA
```
Now to verify that we did indeed replace the right numbers of each column.
```{r}
hw_na_count <- sum(is.na(gradebook$Homework_10))
exam_na_count <- sum(is.na(gradebook$Exam_3))
print(hw_na_count / 150)
print(exam_na_count / 150)
```
Yep, that is 10% of the Homework 10 column and 5% of the Exam 3 column that is NA.

### Part c
Pseudocode for messy_impute.
```{r, eval = FALSE}

```

### Part d
```{r}
new_gradebook <- gradebook
messy_impute(new_gradebook, mean, 1)
```





